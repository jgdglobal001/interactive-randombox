(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2563:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),r=s(2115);function l(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0),[o,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=localStorage.getItem("adminSession"),t=localStorage.getItem("adminSessionTime"),s=Date.now();e&&t&&s-parseInt(t)<864e5&&(n(!0),m())},[]);let i=()=>{if("admin2024!"===d){let e=Date.now().toString();localStorage.setItem("adminSession","authenticated"),localStorage.setItem("adminSessionTime",e),n(!0),m()}else alert("잘못된 비밀번호입니다.")},m=async()=>{try{l(!0);let e=await fetch("/api/admin/codes",{headers:{Authorization:"Bearer admin2024!"}});if(!e.ok){console.error("API 응답 오류:",e.status,e.statusText);let t=await e.text();console.error("에러 데이터:",t),alert("서버 오류: ".concat(e.status," - ").concat(e.statusText));return}let s=await e.json();s.success&&s.codes?t(s.codes):(console.error("API 오류:",s.error),alert(s.error||"코드를 불러오는 데 실패했습니다."))}catch(e){console.error("네트워크 오류:",e),alert("네트워크 오류가 발생했습니다.")}finally{l(!1)}},h=async()=>{try{let e=await fetch("/api/admin/codes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({count:1})});(await e.json()).success&&(alert("새로운 코드가 생성되었습니다."),m())}catch(e){console.error("Failed to generate code:",e),alert("코드 생성에 실패했습니다.")}};return((0,r.useEffect)(()=>{m()},[]),o)?(0,a.jsxs)("div",{className:"container mx-auto p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"관리자 대시보드"}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("adminSession"),localStorage.removeItem("adminSessionTime"),n(!1),t([])},className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600",children:"로그아웃"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("button",{onClick:h,className:"px-6 py-2 bg-blue-500 text-white font-bold rounded-md hover:bg-blue-600",children:"참여 코드 1개 생성"})}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"참여 코드 목록"}),s?(0,a.jsx)("p",{children:"로딩 중..."}):(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2 border-b",children:"코드"}),(0,a.jsx)("th",{className:"p-2 border-b",children:"사용 여부"}),(0,a.jsx)("th",{className:"p-2 border-b",children:"생성일"}),(0,a.jsx)("th",{className:"p-2 border-b",children:"사용일"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-2 border-b font-mono",children:e.code}),(0,a.jsx)("td",{className:"p-2 border-b",children:e.isUsed?"✅ 사용됨":"미사용"}),(0,a.jsx)("td",{className:"p-2 border-b",children:new Date(e.createdAt).toLocaleString()}),(0,a.jsx)("td",{className:"p-2 border-b",children:e.usedAt?new Date(e.usedAt).toLocaleString():"-"})]},e.id))})]})]})]}):(0,a.jsxs)("div",{className:"container mx-auto p-8 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"관리자 로그인"}),(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,a.jsx)("input",{type:"password",value:d,onChange:e=>c(e.target.value),placeholder:"관리자 비밀번호",className:"w-full p-3 border border-gray-300 rounded-md mb-4",onKeyPress:e=>"Enter"===e.key&&i()}),(0,a.jsx)("button",{onClick:i,className:"w-full px-6 py-3 bg-blue-500 text-white font-bold rounded-md hover:bg-blue-600",children:"로그인"})]})]})}},4315:(e,t,s)=>{Promise.resolve().then(s.bind(s,2563))}},e=>{e.O(0,[441,255,358],()=>e(e.s=4315)),_N_E=e.O()}]);
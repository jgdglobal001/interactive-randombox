<!DOCTYPE html>
<html>
<head>
    <title>상품 정보 확인 테스트</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>기프트쇼 상품 정보 확인</h1>
    <button onclick="checkProduct()">상품 정보 확인</button>
    <div id="result"></div>

    <script>
        async function checkProduct() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '조회 중...';

            try {
                // 직접 기프트쇼 API 호출 (CORS 문제로 실패할 수 있음)
                const authKey = 'REAL10f8dc85d32c4ff4b2594851a845c15f';
                const authToken = 'VUUiyDeKaWdeJYjlyGIuwQ==';
                const cardId = '202509120308350';

                const requestData = new URLSearchParams({
                    api_code: '0111',
                    custom_auth_code: authKey,
                    custom_auth_token: authToken,
                    dev_yn: 'N'
                });

                console.log('요청 데이터:', requestData.toString());

                const response = await fetch(`https://bizapi.giftishow.com/bizApi/goods/${cardId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: requestData.toString()
                });

                const result = await response.json();
                console.log('기프트쇼 API 응답:', result);

                if (result.code === '0000' && result.result?.goodsDetail) {
                    const product = result.result.goodsDetail;
                    
                    resultDiv.innerHTML = `
                        <h2>상품 정보</h2>
                        <p><strong>상품명:</strong> ${product.goodsName || 'N/A'}</p>
                        <p><strong>브랜드:</strong> ${product.brandName || 'N/A'}</p>
                        <p><strong>카테고리:</strong> ${product.categoryName1 || 'N/A'}</p>
                        <p><strong>판매가격:</strong> ${product.salePrice || 'N/A'}원</p>
                        <p><strong>할인가격:</strong> ${product.discountPrice || 'N/A'}원</p>
                        <p><strong>실제가격:</strong> ${product.realPrice || 'N/A'}원</p>
                        <p><strong>유효기간:</strong> ${product.limitDay || 'N/A'}일</p>
                        <p><strong>상품설명:</strong> ${product.content || 'N/A'}</p>
                        <p><strong>사용처:</strong> ${product.affiliate || 'N/A'}</p>
                        ${product.goodsImgS ? `<img src="${product.goodsImgS}" alt="상품이미지" style="max-width: 250px;">` : ''}
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <h2>오류</h2>
                        <p>상품 조회 실패: [${result.code}] ${result.message || 'Unknown error'}</p>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                }

            } catch (error) {
                console.error('에러:', error);
                resultDiv.innerHTML = `
                    <h2>에러</h2>
                    <p>${error.message}</p>
                    <p>CORS 문제일 수 있습니다. 개발자 도구 콘솔을 확인해주세요.</p>
                `;
            }
        }
    </script>
</body>
</html>
